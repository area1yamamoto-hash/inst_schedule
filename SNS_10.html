<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Instagramæœˆé–“æŠ•ç¨¿ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«</title>
  <style>
    *{margin:0;padding:0;box-sizing:border-box}
    body{font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,sans-serif;background:#f8fbf8;color:#2d3748;line-height:1.6;padding:20px}
    .container{max-width:1200px;margin:0 auto}
    .header{background:#fff;padding:24px;border-radius:12px;margin-bottom:20px;box-shadow:0 4px 12px rgba(0,0,0,.05);text-align:center}
    h1{color:#1a365d;font-size:2em;margin-bottom:12px}
    .month-year{display:flex;justify-content:center;align-items:center;gap:16px;margin-bottom:20px}
    .month-year input,.month-year select{padding:8px 12px;border:2px solid #48bb78;border-radius:6px;font-size:1.1em;background:#fff}
    .schedule-container{background:#fff;padding:24px;border-radius:12px;box-shadow:0 4px 12px rgba(0,0,0,.05);margin-bottom:20px}
    .schedule-grid{display:grid;grid-template-columns:repeat(7,1fr);gap:8px;margin:16px 0}
    .day-header{background:#2d3748;color:#fff;padding:12px 8px;text-align:center;border-radius:6px;font-weight:600;font-size:.9em}
    .day-cell{background:#f7fafc;padding:8px;border-radius:6px;border:2px solid #e2e8f0;min-height:120px;font-size:.85em;position:relative;cursor:pointer;transition:all .2s}
    .day-cell:hover{border-color:#48bb78;background:#f0fff4}
    .day-number{font-weight:600;color:#4a5568;margin-bottom:4px}
    .post-content{background:#48bb78;color:#fff;padding:4px 6px;border-radius:4px;font-size:.8em;margin:2px 0;font-weight:500;word-break:break-word}
    .post-content.sports{background:#e53e3e}
    .post-content.culture{background:#3182ce}
    .post-content.tourism{background:#d69e2e}
    .post-content.company{background:#805ad5}
    .post-content.stories{background:#48bb78;border:2px dashed #fff}
    .legend{display:flex;gap:16px;justify-content:center;margin:20px 0;flex-wrap:wrap}
    .legend-item{display:flex;align-items:center;gap:8px;font-size:.9em}
    .legend-color{width:16px;height:16px;border-radius:3px}
    .controls{display:flex;gap:12px;justify-content:center;margin:20px 0;flex-wrap:wrap}
    .btn{padding:10px 16px;border:none;border-radius:6px;cursor:pointer;font-weight:600;transition:all .2s}
    .btn-primary{background:#48bb78;color:#fff}
    .btn-primary:hover{background:#38a169}
    .btn-secondary{background:#e2e8f0;color:#2d3748}
    .btn-secondary:hover{background:#cbd5e0}
    .modal{display:none;position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,.5);z-index:1000}
    .modal-content{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);background:#fff;padding:24px;border-radius:12px;max-width:500px;width:90%}
    .modal input,.modal select,.modal textarea{width:100%;padding:8px 12px;border:2px solid #e2e8f0;border-radius:6px;margin-bottom:12px;font-size:1em}
    .modal textarea{min-height:80px;resize:vertical}
    .modal-buttons{display:flex;gap:12px;justify-content:flex-end}

    .instructions{
      background:#fff;
      color:#203744;
      padding:20px 24px;
      border-radius:8px;
      margin-bottom:20px;
      border-left:4px solid #48bb78;
      line-height:1.8;
    }
    .instructions h3{margin-bottom:12px}
    .instructions ul{margin-left:20px}
    .instructions li{margin-bottom:8px}
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <h1>ğŸ“… Instagramæœˆé–“æŠ•ç¨¿ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«</h1>
      <div class="month-year">
        <select id="month" aria-label="æœˆ"></select>
        <label for="month">æœˆ</label>
        <input type="number" id="year" value="2025" min="2024" max="2030" aria-label="å¹´">
        <label for="year">å¹´</label>
      </div>
    </div>

    <div class="instructions">
      <h3>ğŸ“ ä½¿ã„æ–¹</h3>
      <ul>
        <li><strong>æ—¥ä»˜ã‚¯ãƒªãƒƒã‚¯:</strong> æŠ•ç¨¿äºˆå®šã‚’è¿½åŠ ãƒ»ç·¨é›†ã§ãã¾ã™</li>
        <li><strong>ã‚«ãƒ†ã‚´ãƒªé¸æŠ:</strong> ã‚¹ãƒãƒ¼ãƒ„ã€æ–‡åŒ–ã€è¦³å…‰ã€ä¼æ¥­æ´»å‹•ã€ã‚¹ãƒˆãƒ¼ãƒªãƒ¼ã‚ºã‹ã‚‰é¸æŠ</li>
        <li><strong>âš ï¸ ãƒ‡ãƒ¼ã‚¿ä¿å­˜ã«ã¤ã„ã¦:</strong> Claudeç’°å¢ƒã§ã¯ä¸€æ™‚ä¿å­˜ã®ã¿ï¼ˆãƒšãƒ¼ã‚¸æ›´æ–°ã§æ¶ˆå»ï¼‰</li>
        <li><strong>é€±2å›æŠ•ç¨¿:</strong> ç«æ›œï¼ˆ12:00ï¼‰ãƒ»é‡‘æ›œï¼ˆ17:00ï¼‰ã®å®šæœŸæŠ•ç¨¿ã‚’åŸºæœ¬ã¨ã—ã¾ã™</li>
        <li><strong>ã‚¹ãƒˆãƒ¼ãƒªãƒ¼ã‚º:</strong> æ—¥å¸¸çš„ãªã‚¨ãƒ³ã‚²ãƒ¼ã‚¸ãƒ¡ãƒ³ãƒˆå‘ä¸Šã«æ´»ç”¨</li>
        <li><strong>ãƒªãƒ¼ãƒ«æŠ•ç¨¿:</strong> æœˆ1ã€œ2å›ã‚’ç›®å®‰ã«å®Ÿæ–½</li>
        <li><strong>ğŸ’¡ ãƒ’ãƒ³ãƒˆ:</strong> é‡è¦ãªã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã¯åˆ¥é€”ã‚³ãƒ”ãƒ¼ã—ã¦ä¿å­˜ã™ã‚‹ã“ã¨ã‚’ãŠå‹§ã‚ã—ã¾ã™</li>
      </ul>
    </div>

    <div class="legend">
      <div class="legend-item"><div class="legend-color" style="background:#e53e3e"></div><span>ã‚¹ãƒãƒ¼ãƒ„ãƒ»ãƒ›ãƒ¼ãƒ ã‚¿ã‚¦ãƒ³</span></div>
      <div class="legend-item"><div class="legend-color" style="background:#3182ce"></div><span>æ–‡åŒ–ãƒ»æ•™è‚²æ–½è¨­</span></div>
      <div class="legend-item"><div class="legend-color" style="background:#d69e2e"></div><span>è¦³å…‰ãƒ»é£²é£Ÿ</span></div>
      <div class="legend-item"><div class="legend-color" style="background:#805ad5"></div><span>ä¼æ¥­æ´»å‹•ãƒ»åœ°åŸŸè²¢çŒ®</span></div>
      <div class="legend-item"><div class="legend-color" style="background:#48bb78;border:2px dashed #ccc"></div><span>ã‚¹ãƒˆãƒ¼ãƒªãƒ¼ã‚º</span></div>
    </div>

    <div class="controls">
      <button class="btn btn-primary" onclick="generateSchedule()">ğŸ“‹ åŸºæœ¬ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ç”Ÿæˆ</button>
      <button class="btn btn-secondary" onclick="clearSchedule()">ğŸ—‘ï¸ ã“ã®æœˆã‚’ã‚¯ãƒªã‚¢</button>
      <button class="btn btn-secondary" onclick="exportSchedule()" style="background:#38b2ac;color:#fff">ğŸ“¤ ãƒ‡ãƒ¼ã‚¿ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ</button>
    </div>

    <div class="schedule-container">
      <div class="schedule-grid" id="calendar"></div>
    </div>
  </div>

  <!-- ç·¨é›†ãƒ¢ãƒ¼ãƒ€ãƒ« -->
  <div class="modal" id="editModal">
    <div class="modal-content">
      <h3>æŠ•ç¨¿äºˆå®šç·¨é›†</h3>
      <input type="text" id="postTitle" placeholder="æŠ•ç¨¿ã‚¿ã‚¤ãƒˆãƒ«">
      <select id="postCategory">
        <option value="">ã‚«ãƒ†ã‚´ãƒªã‚’é¸æŠ</option>
        <option value="sports">ã‚¹ãƒãƒ¼ãƒ„ãƒ»ãƒ›ãƒ¼ãƒ ã‚¿ã‚¦ãƒ³</option>
        <option value="culture">æ–‡åŒ–ãƒ»æ•™è‚²æ–½è¨­</option>
        <option value="tourism">è¦³å…‰ãƒ»é£²é£Ÿ</option>
        <option value="company">ä¼æ¥­æ´»å‹•ãƒ»åœ°åŸŸè²¢çŒ®</option>
        <option value="stories">ã‚¹ãƒˆãƒ¼ãƒªãƒ¼ã‚º</option>
      </select>
      <textarea id="postNote" placeholder="ãƒ¡ãƒ¢ãƒ»è©³ç´°å†…å®¹"></textarea>
      <div class="modal-buttons">
        <button class="btn btn-secondary" onclick="closeModal()">ã‚­ãƒ£ãƒ³ã‚»ãƒ«</button>
        <button class="btn btn-primary" onclick="savePost()">ä¿å­˜</button>
        <button class="btn" style="background:#e53e3e;color:#fff" onclick="deletePost()">å‰Šé™¤</button>
      </div>
    </div>
  </div>

  <script>
    let scheduleData = {};
    let currentEditingDay = null;
    let editingIndex = null;

    /* -------- ãƒ¡ãƒ¢ãƒªå†…ãƒ‡ãƒ¼ã‚¿ç®¡ç† -------- */
    function loadSchedule(){
      // Claudeç’°å¢ƒç”¨ã®æ”¹å–„ã•ã‚ŒãŸåˆæœŸåŒ–
      if (typeof scheduleData === 'undefined') {
        scheduleData = {};
      }
      
      // ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã‹ã‚‰å¾©å…ƒã‚’è©¦è¡Œï¼ˆClaudeç’°å¢ƒã§ã¯åˆ¶é™ã‚ã‚Šï¼‰
      try {
        const saved = sessionStorage.getItem('tempScheduleData');
        if (saved) {
          const parsedData = JSON.parse(saved);
          // æ—¢å­˜ãƒ‡ãƒ¼ã‚¿ã¨ãƒãƒ¼ã‚¸
          Object.assign(scheduleData, parsedData);
          console.log("ã‚»ãƒƒã‚·ãƒ§ãƒ³ãƒ‡ãƒ¼ã‚¿ã‚’å¾©å…ƒã—ã¾ã—ãŸ");
        }
      } catch (storageError) {
        console.log("ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã¯ä½¿ç”¨ã§ãã¾ã›ã‚“ï¼ˆClaudeç’°å¢ƒã®åˆ¶é™ï¼‰");
      }
      
      console.log("ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ãƒ‡ãƒ¼ã‚¿ã‚’åˆæœŸåŒ–ã—ã¾ã—ãŸ - ã‚¨ãƒ³ãƒˆãƒªæ•°:", Object.keys(scheduleData).length);
    }
    
    function saveSchedule(){
      // ãƒ¡ãƒ¢ãƒªå†…ä¿å­˜ã®ç¢ºèª
      const entryCount = Object.keys(scheduleData).length;
      console.log("ç¾åœ¨ã®ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ãƒ‡ãƒ¼ã‚¿:", entryCount + "å€‹ã®ã‚¨ãƒ³ãƒˆãƒª");
      
      // ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã¸ã®ä¿å­˜ã‚’è©¦è¡Œ
      try {
        sessionStorage.setItem('tempScheduleData', JSON.stringify(scheduleData));
        console.log("ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã«ä¿å­˜ã—ã¾ã—ãŸ");
      } catch (storageError) {
        console.log("ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã«ä¿å­˜ã§ãã¾ã›ã‚“ã§ã—ãŸï¼ˆClaudeç’°å¢ƒã®åˆ¶é™ï¼‰");
      }
      
      console.log("ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ãƒ‡ãƒ¼ã‚¿ã‚’ä¿å­˜ã—ã¾ã—ãŸï¼ˆãƒ¡ãƒ¢ãƒªå†…ï¼‰");
    }

    function clearSchedule(){
      const month = parseInt(document.getElementById("month").value, 10);
      const year = parseInt(document.getElementById("year").value, 10);
      
      // ç¾åœ¨é¸æŠã—ã¦ã„ã‚‹æœˆã®ãƒ‡ãƒ¼ã‚¿ã®ã¿ã‚’å¯¾è±¡ã«ã™ã‚‹
      const currentMonthKeys = Object.keys(scheduleData).filter(key => {
        const [keyYear, keyMonth] = key.split('-').map(Number);
        return keyYear === year && keyMonth === month;
      });
      
      // ãƒ‡ãƒ¼ã‚¿ãŒç©ºã®å ´åˆã®å‡¦ç†ã‚’è¿½åŠ 
      if(currentMonthKeys.length === 0){
        showCustomAlert(`${year}å¹´${month}æœˆã«å‰Šé™¤ã™ã‚‹ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ãŒã‚ã‚Šã¾ã›ã‚“ã€‚`);
        return;
      }
      
      // ã‚«ã‚¹ã‚¿ãƒ ç¢ºèªãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã‚’è¡¨ç¤º
      showCustomConfirm(
        `${year}å¹´${month}æœˆã®ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’å…¨ã¦å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ\nï¼ˆ${currentMonthKeys.length}å€‹ã®ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ãŒå‰Šé™¤ã•ã‚Œã¾ã™ï¼‰\n\nâ€»ä»–ã®æœˆã®ãƒ‡ãƒ¼ã‚¿ã¯ä¿æŒã•ã‚Œã¾ã™`,
        () => {
          try {
            // é¸æŠã—ãŸæœˆã®ã‚­ãƒ¼ã®ã¿ã‚’å‰Šé™¤
            currentMonthKeys.forEach(key => {
              delete scheduleData[key];
            });
            
            saveSchedule();
            generateCalendar();
            showCustomAlert(`${year}å¹´${month}æœˆã®ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’å‰Šé™¤ã—ã¾ã—ãŸã€‚\nï¼ˆå‰Šé™¤æ•°: ${currentMonthKeys.length}å€‹ï¼‰`);
          } catch (error) {
            console.error("ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚¯ãƒªã‚¢ã§ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ:", error);
            showCustomAlert("å‰Šé™¤ä¸­ã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚ãƒšãƒ¼ã‚¸ã‚’å†èª­ã¿è¾¼ã¿ã—ã¦ãã ã•ã„ã€‚");
          }
        }
      );
    }

    /* -------- æœˆ/å¹´ UI -------- */
    function initMonthOptions(){
      const select = document.getElementById("month");
      select.innerHTML = "";
      for(let m=1;m<=12;m++){
        const opt = document.createElement("option");
        opt.value = m;
        opt.textContent = m; // æ•°å­—ã®ã¿
        if(m === new Date().getMonth()+1) opt.selected = true;
        select.appendChild(opt);
      }
    }

    /* -------- ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼æç”» -------- */
    function generateCalendar(){
      const month = parseInt(document.getElementById("month").value,10);
      const year  = parseInt(document.getElementById("year").value,10);
      const calendar = document.getElementById("calendar");
      calendar.innerHTML = "";

      const headers = ["æœˆ","ç«","æ°´","æœ¨","é‡‘","åœŸ","æ—¥"];
      headers.forEach(d=>{
        const h = document.createElement("div");
        h.className = "day-header";
        h.textContent = d;
        calendar.appendChild(h);
      });

      const firstDay = new Date(year, month-1, 1);
      const startDate = new Date(firstDay);
      const offset = (firstDay.getDay() + 6) % 7; // æœˆæ›œåŸºæº–
      startDate.setDate(startDate.getDate() - offset);

      for(let i=0;i<42;i++){
        const date = new Date(startDate);
        date.setDate(startDate.getDate()+i);

        const cell = document.createElement("div");
        cell.className = "day-cell";
        if(date.getMonth() !== month-1) cell.style.opacity = "0.35";

        const dayNumber = document.createElement("div");
        dayNumber.className = "day-number";
        dayNumber.textContent = date.getDate();
        cell.appendChild(dayNumber);

        const key = `${date.getFullYear()}-${date.getMonth()+1}-${date.getDate()}`;
        if(scheduleData[key]){
          scheduleData[key].forEach((post, idx)=>{
            const div = document.createElement("div");
            div.className = `post-content ${post.category||""}`;
            div.textContent = post.title || "(ç„¡é¡Œ)";
            div.title = post.note || "";
            div.addEventListener("click", e=>{
              e.stopPropagation();
              editPost(date, idx);
            });
            cell.appendChild(div);
          });
        }

        cell.addEventListener("click", ()=>editPost(date));
        calendar.appendChild(cell);
      }
    }

    /* -------- ãƒ¢ãƒ¼ãƒ€ãƒ«ç·¨é›† -------- */
    function editPost(date, index=null){
      currentEditingDay = date;
      editingIndex = index;

      const key = `${date.getFullYear()}-${date.getMonth()+1}-${date.getDate()}`;
      const post = (index!==null && scheduleData[key]) ? scheduleData[key][index] : null;

      document.getElementById("postTitle").value    = post ? (post.title||"")    : "";
      document.getElementById("postCategory").value = post ? (post.category||"") : "";
      document.getElementById("postNote").value     = post ? (post.note||"")     : "";

      document.getElementById("editModal").style.display = "block";
    }
    function closeModal(){
      document.getElementById("editModal").style.display = "none";
      currentEditingDay = null;
      editingIndex = null;
    }
    function savePost(){
      if(!currentEditingDay) return;
      const title = document.getElementById("postTitle").value.trim();
      const category = document.getElementById("postCategory").value;
      const note = document.getElementById("postNote").value.trim();
      if(!title || !category){
        showCustomAlert("ã‚¿ã‚¤ãƒˆãƒ«ã¨ã‚«ãƒ†ã‚´ãƒªã¯å¿…é ˆã§ã™ã€‚");
        return;
      }
      const key = `${currentEditingDay.getFullYear()}-${currentEditingDay.getMonth()+1}-${currentEditingDay.getDate()}`;
      if(!scheduleData[key]) scheduleData[key] = [];
      if(editingIndex !== null){
        scheduleData[key][editingIndex] = { title, category, note };
      }else{
        scheduleData[key].push({ title, category, note });
      }
      saveSchedule();
      generateCalendar();
      closeModal();
    }
    function deletePost(){
      if(!currentEditingDay) return;
      const key = `${currentEditingDay.getFullYear()}-${currentEditingDay.getMonth()+1}-${currentEditingDay.getDate()}`;
      if(editingIndex !== null && scheduleData[key]){
        scheduleData[key].splice(editingIndex,1);
        if(scheduleData[key].length===0) delete scheduleData[key];
      }
      saveSchedule();
      generateCalendar();
      closeModal();
    }

    /* -------- åŸºæœ¬ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ç”Ÿæˆ -------- */
    function generateSchedule(){
      const month = parseInt(document.getElementById("month").value,10);
      const year  = parseInt(document.getElementById("year").value,10);
      const lastDay = new Date(year, month, 0).getDate();

      const templates = [
        { title: "ãƒ–ãƒ¬ã‚¤ãƒ´ã‚­ãƒ³ã‚°ã‚¹åˆˆè°· å¿œæ´", category: "sports",  note: "å®šæœŸï¼šç«æ›œ12:00ãƒ»é‡‘æ›œ17:00" },
        { title: "å®‰åŸå¸‚æ­´å²åšç‰©é¤¨ ç‰¹åˆ¥å±•",   category: "culture", note: "å®šæœŸï¼šç«æ›œ12:00ãƒ»é‡‘æ›œ17:00" },
        { title: "åˆˆè°·ãƒã‚¤ã‚¦ã‚§ã‚¤ã‚ªã‚¢ã‚·ã‚¹",     category: "tourism", note: "å®šæœŸï¼šç«æ›œ12:00ãƒ»é‡‘æ›œ17:00" },
        { title: "ã‚¨ãƒªã‚¢ãƒ¯ãƒ³åœ°åŸŸè²¢çŒ®æ´»å‹•",     category: "company", note: "å®šæœŸï¼šç«æ›œ12:00ãƒ»é‡‘æ›œ17:00" }
      ];
      let idx = 0;

      for(let d=1; d<=lastDay; d++){
        const date = new Date(year, month-1, d);
        const dow = date.getDay(); // 0=æ—¥
        if(dow === 2 || dow === 5){
          const key = `${year}-${month}-${d}`;
          if(!scheduleData[key]) scheduleData[key] = [];
          const tpl = templates[idx % templates.length];

          const exists = scheduleData[key].some(p => p.title === tpl.title && p.category === tpl.category);
          if(!exists){
            scheduleData[key].push({ title: tpl.title, category: tpl.category, note: tpl.note });
          }
          idx++;
        }
      }

      saveSchedule();
      generateCalendar();
      showCustomAlert("ã“ã®æœˆã®åŸºæœ¬ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’è¿½åŠ ã—ã¾ã—ãŸï¼ˆæ—¢å­˜ã®äºˆå®šã¯æ®‹ã—ãŸã¾ã¾ã§ã™ï¼‰ã€‚");
    }

    /* -------- ã‚«ã‚¹ã‚¿ãƒ ãƒ€ã‚¤ã‚¢ãƒ­ã‚°æ©Ÿèƒ½ -------- */
    function showCustomAlert(message) {
      const modal = document.createElement('div');
      modal.className = 'modal';
      modal.style.display = 'block';
      
      const modalContent = document.createElement('div');
      modalContent.className = 'modal-content';
      modalContent.style.maxWidth = '400px';
      
      const messageDiv = document.createElement('div');
      messageDiv.style.cssText = 'margin-bottom:20px;line-height:1.6;white-space:pre-line;';
      messageDiv.textContent = message;
      
      const okButton = document.createElement('button');
      okButton.className = 'btn btn-primary';
      okButton.textContent = 'OK';
      okButton.onclick = () => {
        document.body.removeChild(modal);
      };
      
      modalContent.appendChild(messageDiv);
      modalContent.appendChild(okButton);
      modal.appendChild(modalContent);
      document.body.appendChild(modal);
    }

    function showCustomConfirm(message, onConfirm) {
      const modal = document.createElement('div');
      modal.className = 'modal';
      modal.style.display = 'block';
      
      const modalContent = document.createElement('div');
      modalContent.className = 'modal-content';
      modalContent.style.maxWidth = '450px';
      
      const messageDiv = document.createElement('div');
      messageDiv.style.cssText = 'margin-bottom:20px;line-height:1.6;white-space:pre-line;';
      messageDiv.textContent = message;
      
      const buttonDiv = document.createElement('div');
      buttonDiv.style.cssText = 'display:flex;gap:12px;justify-content:flex-end;';
      
      const cancelButton = document.createElement('button');
      cancelButton.className = 'btn btn-secondary';
      cancelButton.textContent = 'ã‚­ãƒ£ãƒ³ã‚»ãƒ«';
      cancelButton.onclick = () => {
        document.body.removeChild(modal);
      };
      
      const confirmButton = document.createElement('button');
      confirmButton.className = 'btn';
      confirmButton.style.cssText = 'background:#e53e3e;color:#fff;';
      confirmButton.textContent = 'å‰Šé™¤ã™ã‚‹';
      confirmButton.onclick = () => {
        document.body.removeChild(modal);
        onConfirm();
      };
      
      buttonDiv.appendChild(cancelButton);
      buttonDiv.appendChild(confirmButton);
      modalContent.appendChild(messageDiv);
      modalContent.appendChild(buttonDiv);
      modal.appendChild(modalContent);
      document.body.appendChild(modal);
    }

    /* -------- ãƒ‡ãƒ¼ã‚¿ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆæ©Ÿèƒ½ -------- */
    function exportSchedule(){
      const dataCount = Object.keys(scheduleData).length;
      if(dataCount === 0){
        showCustomAlert("ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã™ã‚‹ãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚Šã¾ã›ã‚“ã€‚");
        return;
      }
      
      // èª­ã¿ã‚„ã™ã„å½¢å¼ã§ãƒ‡ãƒ¼ã‚¿ã‚’æ•´å½¢
      let exportText = "=== InstagramæŠ•ç¨¿ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ« ===\n\n";
      
      // æ—¥ä»˜é †ã«ã‚½ãƒ¼ãƒˆ
      const sortedKeys = Object.keys(scheduleData).sort((a, b) => {
        const dateA = new Date(a.replace(/-/g, '/'));
        const dateB = new Date(b.replace(/-/g, '/'));
        return dateA - dateB;
      });
      
      sortedKeys.forEach(key => {
        const [year, month, day] = key.split('-');
        exportText += `ã€${year}å¹´${month}æœˆ${day}æ—¥ã€‘\n`;
        
        scheduleData[key].forEach((post, index) => {
          const categoryNames = {
            sports: "ã‚¹ãƒãƒ¼ãƒ„ãƒ»ãƒ›ãƒ¼ãƒ ã‚¿ã‚¦ãƒ³",
            culture: "æ–‡åŒ–ãƒ»æ•™è‚²æ–½è¨­", 
            tourism: "è¦³å…‰ãƒ»é£²é£Ÿ",
            company: "ä¼æ¥­æ´»å‹•ãƒ»åœ°åŸŸè²¢çŒ®",
            stories: "ã‚¹ãƒˆãƒ¼ãƒªãƒ¼ã‚º"
          };
          
          exportText += `  ${index + 1}. ${post.title}\n`;
          exportText += `     ã‚«ãƒ†ã‚´ãƒª: ${categoryNames[post.category] || post.category}\n`;
          if(post.note) {
            exportText += `     ãƒ¡ãƒ¢: ${post.note}\n`;
          }
          exportText += "\n";
        });
        
        exportText += "---\n\n";
      });
      
      // ãƒ†ã‚­ã‚¹ãƒˆã‚¨ãƒªã‚¢ã‚’ä½œæˆã—ã¦è¡¨ç¤º
      const modal = document.createElement('div');
      modal.style.cssText = 'position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.5);z-index:2000;display:flex;align-items:center;justify-content:center;';
      
      const content = document.createElement('div');
      content.style.cssText = 'background:white;padding:20px;border-radius:8px;max-width:80%;max-height:80%;overflow:auto;';
      
      const textarea = document.createElement('textarea');
      textarea.style.cssText = 'width:600px;height:400px;font-family:monospace;font-size:12px;';
      textarea.value = exportText;
      textarea.readOnly = true;
      
      const closeBtn = document.createElement('button');
      closeBtn.textContent = 'é–‰ã˜ã‚‹';
      closeBtn.style.cssText = 'margin-top:10px;padding:8px 16px;';
      closeBtn.onclick = () => document.body.removeChild(modal);
      
      const copyBtn = document.createElement('button');
      copyBtn.textContent = 'ã‚³ãƒ”ãƒ¼';
      copyBtn.style.cssText = 'margin-top:10px;margin-left:10px;padding:8px 16px;background:#48bb78;color:white;border:none;border-radius:4px;';
      copyBtn.onclick = () => {
        textarea.select();
        try {
          document.execCommand('copy');
          showCustomAlert('ãƒ‡ãƒ¼ã‚¿ã‚’ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸï¼');
        } catch (error) {
          showCustomAlert('ã‚³ãƒ”ãƒ¼ã«å¤±æ•—ã—ã¾ã—ãŸã€‚æ‰‹å‹•ã§ãƒ†ã‚­ã‚¹ãƒˆã‚’é¸æŠã—ã¦ã‚³ãƒ”ãƒ¼ã—ã¦ãã ã•ã„ã€‚');
        }
      };
      
      content.appendChild(textarea);
      content.appendChild(document.createElement('br'));
      content.appendChild(copyBtn);
      content.appendChild(closeBtn);
      modal.appendChild(content);
      document.body.appendChild(modal);
    }

    /* -------- åˆæœŸåŒ– -------- */
    window.addEventListener("DOMContentLoaded", ()=>{
      loadSchedule();
      initMonthOptions();
      generateCalendar();

      document.getElementById("month").addEventListener("change", generateCalendar);
      document.getElementById("year").addEventListener("change", generateCalendar);
    });

    // ãƒ¢ãƒ¼ãƒ€ãƒ«èƒŒæ™¯ã‚¯ãƒªãƒƒã‚¯ã§é–‰ã˜ã‚‹
    document.getElementById("editModal").addEventListener("click", (e)=>{
      if(e.target.id === "editModal") closeModal();
    });
  </script>
</body>
</html>